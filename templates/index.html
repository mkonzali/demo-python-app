<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Demo Python App</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <style>
    :root { --violet:#6D3FC0; --ink:#212B5F; --soft:#f6f6fb;}
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin:0; background:var(--soft); color:#222;}
    header { background:var(--violet); color:#fff; padding:18px 24px;}
    h1 { margin:0; font-size:1.6rem;}
    main { max-width:980px; margin:24px auto; background:#fff; border-radius:14px; box-shadow:0 8px 30px rgba(0,0,0,.06); padding:24px;}
    code, pre { background:#111; color:#eee; padding:2px 6px; border-radius:6px;}
    .grid { display:grid; grid-template-columns:1fr 1fr; gap:16px;}
    .card { padding:16px; border:1px solid #eee; border-radius:12px;}
    .btn { background:var(--violet); color:#fff; border:none; padding:10px 14px; border-radius:10px; cursor:pointer;}
    .btn:disabled { opacity:.6; cursor:default;}
    footer { text-align:center; color:#666; font-size:.9rem; padding:16px; }
  </style>
</head>
<body>
  <header>
    <h1>Demo Python App</h1>
  </header>

  <main>
    <div class="grid">
      <div class="card">
        <h3>Build metadata</h3>
        <ul>
          <li><strong>Version:</strong> {{ build.VERSION }}</li>
          <li><strong>Git SHA:</strong> {{ build.GIT_SHA }}</li>
          <li><strong>Build date:</strong> {{ build.BUILD_DATE }}</li>
          <li><strong>Image:</strong> {{ build.IMAGE }}</li>
          <li><strong>Env:</strong> {{ build.ENV }}</li>
        </ul>
      </div>
      <div class="card">
        <h3>API</h3>
        <p>
          <a href="/healthz"><code>GET /healthz</code></a><br/>
          <a href="/api/info"><code>GET /api/info</code></a><br/>
          <a href="/api/error"><code>GET /api/error</code></a> (502 attendu)
        </p>
        <button class="btn" id="btnInfo">Fetch /api/info</button>
        <pre id="out" style="margin-top:12px; padding:12px; border-radius:10px; overflow:auto;"></pre>
      </div>
    </div>
  </main>

  <footer>© Formation Tekton — Demo Python App</footer>

  <script>
    const out = document.getElementById('out');
    const btn = document.getElementById('btnInfo');
    btn.addEventListener('click', async () => {
      btn.disabled = true;
      out.textContent = 'Loading...';
      try {
        const res = await fetch('/api/info');
        const data = await res.json();
        out.textContent = JSON.stringify(data, null, 2);
      } catch (e) {
        out.textContent = 'Error: ' + e.message;
      } finally {
        btn.disabled = false;
      }
    });
  </script>
</body>
</html>
